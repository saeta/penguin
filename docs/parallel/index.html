<!DOCTYPE html>
<html lang="en">
  <head>
    <title>PenguinParallel  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="PenguinParallel  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          PenguinParallel Docs
        </a>
         (75% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/saeta/penguin">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">PenguinParallel Reference</a>
      <img class="carat" src="img/carat.png" />
      PenguinParallel  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Pipelines.html">Pipelines</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PipelineSequence.html">PipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PipelineIteratorProtocol.html">PipelineIteratorProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PipelineIterator.html">PipelineIterator</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Parallel.html">Parallel</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ThreadPool.html">ThreadPool</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Array.html">Array</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Pipeline%20Sequence%20Types.html">Pipeline Sequence Types</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/InterleavePipelineSequence.html">InterleavePipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PrefetchPipelineSequence.html">PrefetchPipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RandomCollectionPipelineSequence.html">RandomCollectionPipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RandomIndicesPipelineSequence.html">RandomIndicesPipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RangePipelineSequence.html">RangePipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ReduceWindowPipelineSequence.html">ReduceWindowPipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SequencePipelineSequence.html">SequencePipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TransformPipelineSequence.html">TransformPipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Zip2PipelineSequence.html">Zip2PipelineSequence</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Collection.html">Collection</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Pipeline%20Iterator%20Types.html">Pipeline Iterator Types</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DropPipelineIterator.html">DropPipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/FunctionGeneratorPipelineIterator.html">FunctionGeneratorPipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/InterleavePipelineIterator.html">InterleavePipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PrefetchPipelineIterator.html">PrefetchPipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RandomCollectionPipelineIterator.html">RandomCollectionPipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RandomIndicesIterator.html">RandomIndicesIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RangePipelineIterator.html">RangePipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ReduceWindowPipelineIterator.html">ReduceWindowPipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ReduceWindowPipelineIterator/Iterator.html">– Iterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SequencePipelineIterator.html">SequencePipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TakePipelineIterator.html">TakePipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TransformPipelineIterator.html">TransformPipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Zip2PipelineIterator.html">Zip2PipelineIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Sequence.html">Sequence</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Parallel%20Internals.html">Parallel Internals</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NaiveThreadPool.html">NaiveThreadPool</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <h1 id='penguin-parallel-parallel-abstractions' class='heading'>Penguin Parallel: Parallel abstractions</h1>

<p><code>PenguinParallel</code> is a toolkit of abstractions for parallel programming. It
contains a number of small, single-purpose components that can be combined to
build higher-level abstractions.</p>
<h2 id='user-friendly-apis' class='heading'>User-friendly APIs</h2>

<p>The user-friendly APIs for expression parallelism represent the two key types of
parallelism explored in this library.</p>

<p>Key abstractions include:</p>

<!-- TODO: Switch to PipelineSequence instead! -->

<ul>
<li><strong>Pipeline Iterators</strong> allow users to structure data and compute using
iterators that can be parallelized across multiple cores. Pipeline iterators
leverage 2 kinds of parallelism: (a) homogenous parallelism, where the same
function is applied to data in parallel, and (b) heterogeneous (pipeline)
parallelism, where two different kinds of operations occur simultaneously on
two independent threads. Homogenous parallelism is exposed via
transformations such as <code>interleave</code>, and <code>map</code> which run the same
computation on different data in two or more threads concurrently. Pipeline
parallelism is epitomised by the <code>prefetch</code> transform, which runs the
computation &ldquo;before&rdquo; the transformation on a background thread, so that all
operations that come &ldquo;after&rdquo; can occur in parallel.</li>
<li><strong>Parallel operations on array</strong> allow users to commpute data-parallel
algorithms easily. Operations such as <code>reduce</code> (and friends <code>max</code>, <code>min</code>,
<code>sum</code>, <code>product</code>, &hellip;), <code>sort</code>, <code>filter</code>, <code>group</code>, <code>map</code> (and many more) can
be easily parallelized across all available cores of a machine.</li>
</ul>

<p>For more details, please check out the documentation for each type.</p>
<h2 id='thread-pool' class='heading'>Thread pool</h2>

<p>From first-principles, a (CPU) compute-bound application will run at peak performance when overheads
are minimized. Once enough parallelism is exposed to leverage all cores, one of the key overheads to
minmiize is context switching, and thead creation &amp; destruction. The optimal system configuration is
thus a fixed-size threadpool where there is exactly one thread per CPU core (or rather, hyperthread).
This configuration results in zero context switching, no additional kernel calls for thread creation &amp;
deletion, and full utilization of the hardware.</p>

<p>Unfortunately, in practice, it is infeasible to statically schedule work apriori onto a fixed pool of threads.
Even when applying the same operation to a homogenous dataset, there will inevitably be variability in
execution time. (This can arise from I/O interrupts taking over a core [briefly], or page faults, or even
different latencies for memory access across NUMA domains.) As a result, it is important for peak
performance to build abstractions that are flexible and dynamic in their work allocation.</p>

<p>The ThreadPool protocol is a foundational API designed to enable efficient use of hardware resources.
There are two APIs exposed to support the two kinds of parallelism:</p>

<ul>
<li><p><strong>prun</strong> is used as &ldquo;fire-and-forget&rdquo; style parallelism where closures are
dynamically scheduled to execute on the (fixed-size) threadpool.</p></li>
<li><p><strong>pJoin</strong> is used for Cilk-style fork-join parallelism using work-stealing
to efficiently leverage available resources on a machine. The key abstraction
is a single function <code>pJoin</code> which takes 2 closures and runs then
(optionally) in parallel.</p></li>
</ul>

<p>Note: while there should be only one &ldquo;physical&rdquo; threadpool process-wide, there can be many virtual
threadpools that compose on top of this one to allow configuration and tuning. (This is why
<code><a href="Protocols/ThreadPool.html">ThreadPool</a></code> is a protocol and not static methods.) Examples of additional threadpool abstractions
could include a separate threadpool per-NUMA domain, to support different priorities for tasks, or
higher-level parallelism primitives such as &ldquo;wait-groups&rdquo;.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2020 <a class="link" href="https://github.com/saeta" target="_blank" rel="external">Brennan Saeta <a href="mailto:saeta@google.com">saeta@google.com</a></a>. All rights reserved. (Last updated: 2020-04-02)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.0</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
